
<!-- Button trigger modal -->
<div class="btn btn-lincoln" data-toggle="modal" data-target="#myModalCreateCompanyNote">
  Add Company to Note
</div>

<!-- Modal -->
<div class="modal fade" id="myModalCreateCompanyNote" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="myModalLabel">Add Company</h4>
      </div>
      <div class="modal-body">

        <!-- Validation failure messages -->

        <% if @company_note.blank?%>
          <% @company_note = CompanyNote.new %>
        <% end %>
        <% if @company_note.errors.any? %>
          <% @company_note.errors.full_messages.each do |message| %>
            <div class="alert alert-dismissable alert-danger">
              <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
              <%= message %>
            </div>
          <% end %>
        <% end %>

        <form enctype="multipart/form-data" action="/create_company_note" method="post" class="form-horizontal">
          <!-- Hidden input for authenticity token to protect from forgery -->
          <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">

          <!-- js-switch elements for formatting -->
          <div>
            <input type="hidden" class="js-switch" />
            <input type="hidden" class="js-switch_2" />
            <input type="hidden" class="js-switch_3"  />
            <input type="hidden" class="js-switch_4"  />
          </div>

            <!-- Label and input for Company -->
            <div class="form-group">
              <h5><label for="company_id" class="col-sm-2 control-label">
                Company
              </label></h5>
              <div class="col-sm-10">
                <select name="company_id" data-placeholder="Choose a Company..." class="chosen-select back-change"  tabindex="2">
                  <% Company.where(id: (Company.ids - CompanyNote.where(note_id: @note.id).pluck(:company_id)).uniq).order("name asc").each do |company| %>
                  <option value="<%=company.id %>"><%=company.name %></option>
                  <% end %>
                </select>
              </div>
            </div>

          <input name="note_id" type="hidden" value="<%= @note.id %>">

          <div class="form-group pull-left">
            <div class="col-sm-offset-2 col-sm-10">
              <button class="btn btn-lincoln">
                Add Company to Note
              </button>
            </div>
          </div>
          <br>
        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
$(function() {

    var elem = document.querySelector('.js-switch');
    var switchery = new Switchery(elem, { color: '#1AB394' });

    var elem_2 = document.querySelector('.js-switch_2');
    var switchery_2 = new Switchery(elem_2, { color: '#ED5565' });

    var elem_3 = document.querySelector('.js-switch_3');
    var switchery_3 = new Switchery(elem_3, { color: '#1AB394' });

    var elem_4 = document.querySelector('.js-switch_4');
    var switchery_4 = new Switchery(elem_4, { color: '#f8ac59' });
   
    $('.chosen-select').chosen({width: "100%"});
});
</script>